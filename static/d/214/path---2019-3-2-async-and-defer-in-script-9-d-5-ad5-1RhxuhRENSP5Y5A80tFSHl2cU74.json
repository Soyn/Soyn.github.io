{"data":{"site":{"siteMetadata":{"title":"Bee starter","author":"[Your Name]","siteUrl":"https://gatsby-starter-bee.netlify.com","comment":{"disqusShortName":"","utterances":"JaeYeopHan/gatsby-starter-bee"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"d073d1cf-dbae-585c-a0b6-3071dc500c32","excerpt":"在访问网页的时候，浏览器是如何渲染当前的页面的？浏览器获取到输入（ 、 、 ）的时候，输入中有 的信息，有样式信息， 代码，在加载页面的时候，如果 的加载和解析太耗时的话，首屏的大量留白是很影响用户体验的，这里我们来看看，对于 在页面中的加载对 的加载的性能影响。 Script…","html":"<p>在访问网页的时候，浏览器是如何渲染当前的页面的？浏览器获取到输入（<code class=\"language-text\">HTML</code>、<code class=\"language-text\">CSS</code>、<code class=\"language-text\">Javascript</code>）的时候，输入中有<code class=\"language-text\">DOM Tree</code>的信息，有样式信息，<code class=\"language-text\">Javascript</code>代码，在加载页面的时候，如果<code class=\"language-text\">DOM</code>的加载和解析太耗时的话，首屏的大量留白是很影响用户体验的，这里我们来看看，对于<code class=\"language-text\">Scritp</code>在页面中的加载对<code class=\"language-text\">HTML</code>的加载的性能影响。</p>\n<h2 id=\"script在页面中的位置\"><a href=\"#script%E5%9C%A8%E9%A1%B5%E9%9D%A2%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE\" aria-label=\"script在页面中的位置 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Script在页面中的位置</h2>\n<p><code class=\"language-text\">script</code>标签在页面中放置的位置对于整个页面的加载和功能影响是很大，默认情况下，浏览器在解析<code class=\"language-text\">HTMl</code>页面的时候，遇到<code class=\"language-text\">script</code>标签，如果是<code class=\"language-text\">inline</code>的话，会立即执行<code class=\"language-text\">script</code>标签中的代码，这里就牵扯一个问题，浏览器对<code class=\"language-text\">HTML</code>的解析是按照<code class=\"language-text\">HTML</code>内容的输入顺序执行的，如果<code class=\"language-text\">script</code>在<code class=\"language-text\">head</code>中，如果需要操作<code class=\"language-text\">DOM</code>，这个时候浏览器对文档的解析并没有结束，可能这时候需要的<code class=\"language-text\">DOM</code>并不存在。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./style.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>link</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\">\n      <span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Dom Length: '</span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>如上，是一个<code class=\"language-text\">inline</code>的<code class=\"language-text\">script</code>，在<code class=\"language-text\">script</code>的代码中去取<code class=\"language-text\">DOM</code>，这个时候浏览器在执行这段代码的时候，浏览器并没有解析到对应的<code class=\"language-text\">DOM</code>。</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 33.57041251778094%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAAhklEQVQoz62OzQrEIAyEff9X9NKq4EFXqhZc/JuaHkoP3VKWDnxIMiYTJoSAUgrGWMQYBwEhhFEbkOec2/u1VpRS8E0J8zRhHp6UEt57aK13OOdgy+Jh7AfrmpBzQ+8NrdHbD6i+gjwKonBr7ZjPYPgh+vyP2PmSO85Bd97jhU9heFmvL9wAuYcnk5cCoq4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"inline in head\"\n        title=\"\"\n        src=\"/static/902439bf615502def2479177dc6495fa/e41c6/inline_in_head.png\"\n        srcset=\"/static/902439bf615502def2479177dc6495fa/7c8aa/inline_in_head.png 148w,\n/static/902439bf615502def2479177dc6495fa/1e920/inline_in_head.png 295w,\n/static/902439bf615502def2479177dc6495fa/e41c6/inline_in_head.png 590w,\n/static/902439bf615502def2479177dc6495fa/17e43/inline_in_head.png 703w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span></p>\n<p>所以，为了避免这种情况，一般来说，会将script标签放置在<code class=\"language-text\">&lt;/body&gt;</code>标签前，这个时候，所有的<code class=\"language-text\">DOM</code>都解析好了，不存在找不到<code class=\"language-text\">DOM</code>的情况。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./style.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>link</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\">\n      <span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Dom Length: '</span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>    \n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 33.0532212885154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAAc0lEQVQoz7WP2wqAIBBE/f//tKQeNJDF++QahfVm0cDAru4eHTErBTlN0HoDkYf3Ds4dJqLae4QQEGNs5prP2TxjrYWUEsuywhgDkVJqQzlnlIJh8d75MLPE/bpU6Jh7NeAo4Anr6+uH5U3WPtcT+FW/AndRcyplJkdOMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"inline in body\"\n        title=\"\"\n        src=\"/static/3174ed35b9647e0cf017de6ae37d1855/e41c6/inline_in_body.png\"\n        srcset=\"/static/3174ed35b9647e0cf017de6ae37d1855/7c8aa/inline_in_body.png 148w,\n/static/3174ed35b9647e0cf017de6ae37d1855/1e920/inline_in_body.png 295w,\n/static/3174ed35b9647e0cf017de6ae37d1855/e41c6/inline_in_body.png 590w,\n/static/3174ed35b9647e0cf017de6ae37d1855/541e2/inline_in_body.png 714w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span></p>\n<h2 id=\"外部script的加载对html解析的影响\"><a href=\"#%E5%A4%96%E9%83%A8script%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%AF%B9html%E8%A7%A3%E6%9E%90%E7%9A%84%E5%BD%B1%E5%93%8D\" aria-label=\"外部script的加载对html解析的影响 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>外部Script的加载对HTML解析的影响</h2>\n<p>在加载外部的<code class=\"language-text\">script</code>的时候，<code class=\"language-text\">script</code>的加载对于页面的性能影响更加明显，加载外部脚本的时候牵扯发外部的请求去请求脚本，这个时候<code class=\"language-text\">HTML</code>的解析是被阻塞住的，外部<code class=\"language-text\">script</code>加载成功后，马上执行<code class=\"language-text\">script</code>脚本，执行完后，才继续解析剩下的<code class=\"language-text\">HTML</code>。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./style.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>link</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./app.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 36.954662104362704%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABf0lEQVQozzWQ23LaMBRF/f//0L/oY6cvbSelhBQoNGni2oADtiRLRnawsWyzIi7RzJqt2TraOkfBfLVhtloz/2B9ZRqvmMVXPfuj54hxGN28G6tb3Yd6gmiTkGnDVuSkuSHZ5X5vEaYgtyWvqkDtra+5qjAG7f1MSLSvkR5TlhfVXoPOOUTR8vi8Y/43YrFIWXz7hXwVqMySyIZs75CerhuAE4NR0FT0byXD0F84nXrOK8iEoDk21D74bV9wFFvaIqPyr7XNkbbtOLaOo+twPq9XObkWTKOQolaoSlI0BlPnhOI/wXIy4/f4D9lsSrlNqeuO1l+UpmSbKVKZI8/j7gTyxdc9fGG5fOHu7okkkcTJjjjd+KYGEiUJYj/mfPRIHYaXsIOnbjqsqTBqj9UWaw+UqUZNPpN+/8Tk60/i+wi51uy8v5EbZGmpakcgRcZhbyi1xumc3h+48B/twwj3tMBN72nHP+gLzVAUOFtx/vehd/TNAd+F90rWeewDK94B2FcJkjllt50AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"extend script in body\"\n        title=\"\"\n        src=\"/static/e7fcce1b32423cec4032540a3a637c6e/e41c6/extend_script_in_body.png\"\n        srcset=\"/static/e7fcce1b32423cec4032540a3a637c6e/7c8aa/extend_script_in_body.png 148w,\n/static/e7fcce1b32423cec4032540a3a637c6e/1e920/extend_script_in_body.png 295w,\n/static/e7fcce1b32423cec4032540a3a637c6e/e41c6/extend_script_in_body.png 590w,\n/static/e7fcce1b32423cec4032540a3a637c6e/8067e/extend_script_in_body.png 885w,\n/static/e7fcce1b32423cec4032540a3a637c6e/7e3c8/extend_script_in_body.png 1169w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n从上图的<code class=\"language-text\">profile</code>的图我们可以发现，浏览器在解析<code class=\"language-text\">HTML</code>的时候，默认在解析到<code class=\"language-text\">script</code>标签的时候，会加载对应的<code class=\"language-text\">Javascript</code>代码，加载完成后立即执行，这个过程会将<code class=\"language-text\">HTML</code>解析阻塞住，那有没有办法解决页面阻塞的问题呢？在<code class=\"language-text\">HTML5</code>中引入了<code class=\"language-text\">async</code>和<code class=\"language-text\">defer</code>这两个属性，可以解决<code class=\"language-text\">script</code>加载阻塞页面解析的问题。</p>\n<h2 id=\"script中的async和defer属性\"><a href=\"#script%E4%B8%AD%E7%9A%84async%E5%92%8Cdefer%E5%B1%9E%E6%80%A7\" aria-label=\"script中的async和defer属性 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Script中的Async和Defer属性</h2>\n<p>首先我们看看<code class=\"language-text\">MDN</code>对这两个属性的解释：\n<span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 50.05370569280344%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABWUlEQVQoz3WSi26DMAxF9/8fuEmbtC0lpZRnQhIIr9zZAbrSrUhHtnnccG2/hBDA1zAMqOsaddOgIbSxUJ2HJrZXnl67BseXvej7Hte8gCga2K7HSAcwg/fwG/f5zjLPN7GD4LIsKMoS8nxGWVVwXQfrHAyx5xzvc44zfXf/l7+C44js9Q2VENCJhE0vMOc0oukQQ7W7ZDcsQ/d8UYJUER4tBxK07x8w4gTzLQ6ozy8MaYo5u2IiIYbzkQQnimGa/vaQY0VWS7K9wzUPSmsFYwzatr2htYYjy+FhMIceskie5yiKIopxvBKtdfA0oK736OIwhjhEhrfj6VBkkkBQD6WUkYTqlCydyFqWlxDUT0n1hSzz8yzL4l/+K8iR92/dQ0WTrqHI1jxPmKYxrgfnK8vKNmFsYgfLgR7yihg/ou0HKOdhrI3907pdl50OUEpDuz4uPEfnj5Z/ANgxBWsA67tyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"extend async mdn\"\n        title=\"\"\n        src=\"/static/ae9786c7e3b6e7befa12744ad2927e85/e41c6/extend_async_mdn.png\"\n        srcset=\"/static/ae9786c7e3b6e7befa12744ad2927e85/7c8aa/extend_async_mdn.png 148w,\n/static/ae9786c7e3b6e7befa12744ad2927e85/1e920/extend_async_mdn.png 295w,\n/static/ae9786c7e3b6e7befa12744ad2927e85/e41c6/extend_async_mdn.png 590w,\n/static/ae9786c7e3b6e7befa12744ad2927e85/8067e/extend_async_mdn.png 885w,\n/static/ae9786c7e3b6e7befa12744ad2927e85/8db94/extend_async_mdn.png 931w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n如上，是<code class=\"language-text\">async</code>属性对<code class=\"language-text\">script</code>标签的加载和执行的影响：</p>\n<ul>\n<li><code class=\"language-text\">async</code>为<code class=\"language-text\">true</code>的<code class=\"language-text\">script</code>是异步加载和执行的，加载过程不会阻塞浏览器对<code class=\"language-text\">HTML</code>的解析</li>\n<li>有多个<code class=\"language-text\">async</code>为<code class=\"language-text\">true</code>的<code class=\"language-text\">script</code>的执行的顺序是不确定的，执行顺序并不是脚本的引用顺序</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./style.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>link</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">async</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>true</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./app.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 39.63414634146341%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABlElEQVQoz12RbW/UMBCE8///DnxsvwBShSpRWq5IV3pUPS7Nm/NqO7GTOA+b9FokIo0ir8ezO7ORMYZCKewwoOoa3XXUVfWKuiXNK7QZyPKSpnHCrel0RyvvSuHoTqPk/aZTFEQLsHhPaGoWEQzLWpGaoEgVx90tv3/cobOUfH/ANYowToS2gWnk/y+appnRj3it8cdnnHRy8Ql9+oO5uyW7uMAc9gxljlcxrlYMqsR9/4ZNMqquJW8TTupE1qZEeSFWWo31M7assLsdpqxx1lA9PnF5FTOK9XUWoTAKhiDDSeP2peIkU3da0fRytpoojmOyLEOJ/0Is118+0WYJN4eUr9e/6EWMtmZeYwiBRSKx/YAR/vPnj1x/uOT+JiVJE/aPD0Tv5s/ZhaoEsTGYniq3uLSQbMst0zfBV1HDy9NPjocHWVSDKkuSIiEaZLsrIZzJwQ24JGFWOYjQVOQE4YS12Zkzz/M2gHELul/DCNsWe2+J3oXWv2Dd8hSWzeIbZKbt/p/gKhDQ1kt+TmqBaZrwzvMXJsVk6z/7ShcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"async profile\"\n        title=\"\"\n        src=\"/static/79a6e4535a5ef20d151aede4574c837c/e41c6/async_profile.png\"\n        srcset=\"/static/79a6e4535a5ef20d151aede4574c837c/7c8aa/async_profile.png 148w,\n/static/79a6e4535a5ef20d151aede4574c837c/1e920/async_profile.png 295w,\n/static/79a6e4535a5ef20d151aede4574c837c/e41c6/async_profile.png 590w,\n/static/79a6e4535a5ef20d151aede4574c837c/8067e/async_profile.png 885w,\n/static/79a6e4535a5ef20d151aede4574c837c/9a912/async_profile.png 984w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n从上面的<code class=\"language-text\">profile</code>的图可以很明显的看到这个过程，<code class=\"language-text\">Javascript</code>的加载和<code class=\"language-text\">HTML</code>的解析是并行的，并不会阻塞<code class=\"language-text\">HTML</code>的<code class=\"language-text\">parse</code>，但是<code class=\"language-text\">javascript</code>代码的执行的实际这里是无法确定的。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./style.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>link</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">async</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>true</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">async</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>true</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./app.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>如上，我们在这里从<code class=\"language-text\">cdn</code>上引入了<code class=\"language-text\">JQuery</code>的代码，我们来看看这里<code class=\"language-text\">async=true</code>的时候，对<code class=\"language-text\">javascript</code>代码的执行情况的影响。\n<span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 39.1124871001032%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABk0lEQVQozz2SiWrbQBCG9f7P0JcpJLTghlAIKcSmPmIdtla72lOn/XUkhwp+dq79Z/7RZsYY8jynrhXOeYqy4nKtsdZJrEG3lmGaSamjUc0jrjTnosbYSGO82Fe01hijyZBvGGeCD8xTZOiEIFnuc1oxjwFu3XrOg5fqkfvQMNott3gQ7JncX6R4oSLz3jMMA83pg7rYo1TBtTygVU4fG5JXgnq1u6AEmqR3hOIJX/7AF8+E669VxTDfyC6NpTzlbDdvtLsjYxjp7tCP0AnS8EAUhP5OFIRebPFtkpzUhqrltPku93dk3QRedrF9+cPx94bq9SeX6kxlWi7KUNUapa0QzYKbkN9X4iC2XfxzSXh/Z/f0jfbtlWwpWiYpVY9yUbr22NMn7WdOKws3baD13YNQyGKaSDJikvhClk6F+COHZo+NkWzpuMgrzYRL80oeF6miJ2lHEmeVLI1X+J4oa4qNI4juOD/WYYLDyzBZnheczzlHmaisLnj528vzcTHhQsQtvsB/nUvMS85/5b3U/r8j5z9dvGLax9UhXQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"async jquery\"\n        title=\"\"\n        src=\"/static/47d3dace03f49cb0ff06c0d44049160e/e41c6/async_jquery.png\"\n        srcset=\"/static/47d3dace03f49cb0ff06c0d44049160e/7c8aa/async_jquery.png 148w,\n/static/47d3dace03f49cb0ff06c0d44049160e/1e920/async_jquery.png 295w,\n/static/47d3dace03f49cb0ff06c0d44049160e/e41c6/async_jquery.png 590w,\n/static/47d3dace03f49cb0ff06c0d44049160e/8067e/async_jquery.png 885w,\n/static/47d3dace03f49cb0ff06c0d44049160e/594ec/async_jquery.png 969w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n在上面的<code class=\"language-text\">profile</code>的图中，我们可以很明显的看到，<code class=\"language-text\">javascript</code>代码的执行顺序，和<code class=\"language-text\">script</code>的引入顺序并不一致。\n我们接着来看看<code class=\"language-text\">defer</code>属性对<code class=\"language-text\">script</code>标签的影响：\n<span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 47.368421052631575%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQoz5VR7XKCMBD0/d+qfYjaqtRBUfIBJAQKyEe2d0Es+q+Z2dk7kiybvY33Hrycc4iiCFJKpGkaWCkFIURg7sOekBBSBUilUZYl8jzHMAxBZ7MIMltjwqYpChQrWGuRZRm01khVBqlzCE19btD3PW63G6ZpehYcxhGKLjAeLskZi7BLQz8zJGxMMdfEdV3DkkP+3rbts+BIlh25qemAowuMylhULELumqqiQyMmcvSHAX4YCcSvDnvK8Pj2DrX9hP7YBmT3uoy+YQ4RzG4Puz8ElNQzF1871LTvXQX/lCHl0KcCLWXTUtgNPZeZ4cn1DLdC+eCJXuNfn8wZJtcrLoTkckF8OgVe6nOSID6fwxnuGcc4DvsFC86TXWVIgjwInmbbNCHwhpjD5r7rulB33N/R/Mzfl/z8WpCZR7/0/13LvV8I27KKF+kBzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"extend defer mdn\"\n        title=\"\"\n        src=\"/static/3ee27e2f2c6c824529cea2ec64ce517b/e41c6/extend_defer_mdn.png\"\n        srcset=\"/static/3ee27e2f2c6c824529cea2ec64ce517b/7c8aa/extend_defer_mdn.png 148w,\n/static/3ee27e2f2c6c824529cea2ec64ce517b/1e920/extend_defer_mdn.png 295w,\n/static/3ee27e2f2c6c824529cea2ec64ce517b/e41c6/extend_defer_mdn.png 590w,\n/static/3ee27e2f2c6c824529cea2ec64ce517b/f6060/extend_defer_mdn.png 836w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n根据<code class=\"language-text\">MDN</code>的解释，在<code class=\"language-text\">defer</code>属性为<code class=\"language-text\">true</code>的情况下，<code class=\"language-text\">script</code>标签会异步加载，脚本的执行是按照<code class=\"language-text\">script</code>标签在<code class=\"language-text\">HTML</code>中出现顺序执行，等所有的<code class=\"language-text\">script</code>执行完毕之后才会触发<code class=\"language-text\">DOMContentLoaded</code>事件。\n<span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 17.04119850187266%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAzElEQVQI1yWM30vCUABG9/8/+xQahCBpPYSSI0SUksowaWpBeu927zZXuF8grVu+nGZ7OJzvvHyWWr0TeyF58EmmI4oD/PyCSb8w+Tcm2WOyotxF5WMf2WUcPhJMuKW4G/PWnyAmc6yXwQmrUQNnVEfYNYKHM/TyArXsVCzaaKeNcirrWRM9PiUcthCDBv5iRjR9JJAuUmqs2/Jo/nyO59mIdRf5eln6io3b+0f4NpvdEKmukbqPFF3W2xtC/55cPpFGmkS5xGlOnO35A3a40v3fMu2oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"defer profile\"\n        title=\"\"\n        src=\"/static/6d0e58a4e2a4c93cd4b5f002477fcd47/e41c6/defer_profile.png\"\n        srcset=\"/static/6d0e58a4e2a4c93cd4b5f002477fcd47/7c8aa/defer_profile.png 148w,\n/static/6d0e58a4e2a4c93cd4b5f002477fcd47/1e920/defer_profile.png 295w,\n/static/6d0e58a4e2a4c93cd4b5f002477fcd47/e41c6/defer_profile.png 590w,\n/static/6d0e58a4e2a4c93cd4b5f002477fcd47/8067e/defer_profile.png 885w,\n/static/6d0e58a4e2a4c93cd4b5f002477fcd47/037a4/defer_profile.png 1068w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n对于<code class=\"language-text\">script</code>的加载和执行，结合文中实际的例子，我们总结一下：</p>\n<ul>\n<li><code class=\"language-text\">script</code>标签默认是同步加载，加载完成之后立即执行</li>\n<li><code class=\"language-text\">async</code>为<code class=\"language-text\">true</code>的时候，<code class=\"language-text\">script</code>的加载是异步的（不会阻塞<code class=\"language-text\">HTML</code>的解析过程），代码的执行顺序不一定是<code class=\"language-text\">script</code>标签出现的顺序。</li>\n<li><code class=\"language-text\">defer</code>的加载和<code class=\"language-text\">async</code>是异步的不会阻塞<code class=\"language-text\">HTML</code>的<code class=\"language-text\">parse</code>，和<code class=\"language-text\">async</code>区别在于，<code class=\"language-text\">defer</code>标签的执行是按照在文档中定义的顺序执行的，在代码执行完毕之后才触发<code class=\"language-text\">DOMContentLoaded</code>，<code class=\"language-text\">async</code>的代码的执行并不对<code class=\"language-text\">DOMContentLoaded</code>有影响（代码的执行可能在<code class=\"language-text\">DOMContentLoaded</code>事件之后，意味着如果在<code class=\"language-text\">async</code>为<code class=\"language-text\">true</code>的脚本中拿不到<code class=\"language-text\">DOMContentLoaded</code>的事件)]</li>\n</ul>\n<h1 id=\"reference\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<ul>\n<li><a href=\"https://flaviocopes.com/javascript-async-defer/\">Efficiently load JavaScript with defer and async</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script\">The Script element</a></li>\n</ul>\n<hr>\n<p><strong><em>兴趣遍地都是，坚持和持之以恒才是稀缺的</em></strong></p>","frontmatter":{"title":"script在HTML中的加载","date":"March 02, 2019"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2019-3-2-AsyncAndDeferInScript/","previous":{"fields":{"slug":"/2019-2-23-WriteYourOwnAmdLoader/"},"frontmatter":{"title":"自己动手写AMD Loader","category":"Tech"}},"next":{"fields":{"slug":"/2019-3-16-ESModule/"},"frontmatter":{"title":"ES6 Module","category":"Frotnend ES6"}}}}