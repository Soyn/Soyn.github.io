{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019-6-15-mvvm/","result":{"data":{"site":{"siteMetadata":{"title":"Move fast and break things.","author":"wang yao","siteUrl":"http://cuteshilina.com","comment":{"disqusShortName":"","utterances":"Soyn/Soyn.github.io.git"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"c36efad7-0d7b-5802-b06b-ebdda3165a82","excerpt":"…","html":"<p>在前端的学习中，经常会听到双向绑定（<code class=\"language-text\">MVVM</code>）这个概念，双向绑定的概念很简单，就是视图（<code class=\"language-text\">View</code>）上的更新能够实时更新数据层（<code class=\"language-text\">Model</code>），同时数据层的更新也会实时更新到视图层。不同于<code class=\"language-text\">MVC</code>的数据单向流动（从数据层到视图层），那么如何实现数据和视图的双向绑定呢？\n实现数据的双向绑定，首先我们要搞明白面临的问题：</p>\n<ul>\n<li>如何监听试图层的变化？</li>\n<li>视图层变化之后如何更新到数据层？</li>\n<li>如何监听数据层的变化？</li>\n<li>如何将数据层的变化更新到视图层？</li>\n</ul>\n<p>视图层的更新主要是来自用户的输入行为（输入、点击等），我们可以通过监听事件的方式（<code class=\"language-text\">keyup</code>、<code class=\"language-text\">keydown</code>等），在事件回调中获取视图层的更新，将更新同步到数据层上，由于数据层的更新，我们再用数据去刷视图层，这样就是实现了双向绑定，从网上获取的资料来看，主要有以下几种实现方式：</p>\n<h1 id=\"手动绑定\" style=\"position:relative;\"><a href=\"#%E6%89%8B%E5%8A%A8%E7%BB%91%E5%AE%9A\" aria-label=\"手动绑定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>手动绑定</h1>\n<p>这里手动绑定的意思是，在<code class=\"language-text\">DOM</code>上绑定事件回调，在事件回调函数值中去更新数据层和重新渲染视图，简单的实现如下：\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 110.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/UlEQVQ4y51US08UQRDeM+4uK7s7szM90/Psee0DiK/EH6AmEiPGk170YvSGBwPxwkkSE19IFBCIC1EIgRW9YAIe9AI/67N6FvCBC6yHLz09XfV1VX1VnVnd/I7W9g7Wt3bQktjuHp+2d7HxbRermz+QWdrYwuPxCYyMjuHBozHcHxntDg/b68jYOJqtr8hMLbVwMUlQFb3I20Xks7T2Fk6OQgGnsjkoFR2T8x+ReTX3AaJah667BANlnaGs6SipKspqhaCSsdYRqrRVVJi2g6dT88g8m25CRBFCn6KM+yHq5+D4dVimB2a7qDg+lD2n9gWHUSyXwbiFJy9n2oSOCGDbHgYHzsMwOFRVR0UzoFK0ioyanI4kLBGhKQmn24SuCOkWBXHYD9cJ0TBtcNNBH90sifbJOpGmhHyf8G0TXhCh0FdE4DYQ+f1ILB+hVwcz7GOjO0y4F6GqaQhEDZ4bw3MEDJ0fOJyI8PeUHT+AzgxUqwOIwhrCWh1GmJDS2rHpdqxhhZR0XAFuuShTTym6Sat28hr+TajQQTUZRBhU4XOHRHHBDQ8W96GR0l1FKEU5TaJEHqXsNXDGk21E/VdhUCnarlOWhH3FEqlcQyIGEBMSJ4Zwk/9L2ZM1NEwwikzRaPTIUSVDWYbSEep27EM3CGFRq3hBg8SgFIm8SDMsDUvU3LLp0+90r/zCXsTy/M8+JEJpwCnsSNQhamfhezFMUl3zIxjcg0N7XcTpfBs0phU3gMbN9PGQ5Tqkcl+5BCuI4VLdXE6ieBEY9SITCTg586gBk85NmntGnaASgcpYihIJx7j9i9APYxhCQDQuwKRXxrI8aA6BlNZllPTi6DSGjJmoUJ/KS3QqEbPpn0t28kKySwmfzyzSxkWBcRSoTbK5HLL5PHI5QrrmDr6z+d72uvcvtSP09PSkT9jE5CwybxbXcOvuPVweGsalq9fbGOqAf54N48q1G7h5+w4mF5aRaa5vYm7lC14vrODF7BJkxN1A+kzOL+Pd8me8X9vET08l2TgpomAPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"HandSetHtml\"\n        title=\"HandSetHtml\"\n        src=\"/static/84e65ec1e909cf16f05d4d970f70098a/fcda8/handSetHTML.png\"\n        srcset=\"/static/84e65ec1e909cf16f05d4d970f70098a/12f09/handSetHTML.png 148w,\n/static/84e65ec1e909cf16f05d4d970f70098a/e4a3f/handSetHTML.png 295w,\n/static/84e65ec1e909cf16f05d4d970f70098a/fcda8/handSetHTML.png 590w,\n/static/84e65ec1e909cf16f05d4d970f70098a/9128f/handSetHTML.png 603w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n如上，我们在<code class=\"language-text\">HTML</code>中有一个<code class=\"language-text\">input</code>元素用来输入，另一个<code class=\"language-text\">div</code>元素用来显示输入的元素；在这两个元素上我们声明了特定的属性<code class=\"language-text\">q-value</code>和<code class=\"language-text\">q-text</code>，这两个属性名标示着和数据层的绑定关系，如下，是相关的JS代码：\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 588px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 153.3783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAYAAADnTu3OAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEbUlEQVRIx51Wy24cRRSdDyCxPZ5+VXV39aP6MeOxx7HzIkJiHZAIKERix4Z8QhZICDlGcSRih0QxAgskApIXiFjsgoAVEvBbh3NrZowdjxPD4qh63FWn7z333Fvu/Pj8Dzz77S88+1Xw5//CAc8f/P43hKvz9OAXbNz/Ah9v3sedjS3c+XSKe2fEeP8nWw8hXJ3tvR9wpaoxWg3QzX0szHWxsNhDl5iuDr3T4GF+oYvYZHhIrs69R3uomwplGSMqaqi8gNIaXhDBDyO3jhHOhOxZ9HwkWYGtx3vobG7vIitKNOUQ/XoddTVC364SFzAgimoJejBCYhsEkULPD06QOkKTY3P7S3Q2Pn8Cy5RzfiEr+jDGIk0KQtYSKskRmAIR8TJCSfnug90xYVVXaImE0USZ4Sbq6XlY9H30PIE3xoTsRdJjhHcfPIEpLA9QJ27s9nxuCCZE/onDZ4qwbiz1K2DaIeoLq7BNDmUmqcap+1DvEOGR52B2hCKoSQ3qOkNTtahtizS30M0ACT8SUt+oZFHSHKGKnL4mrRCEajZhygMmLRDHBlkWO6g4mUSYwGcxPKXRC8fRCVEY6UM7vUC4izjNEOsUK8s1rl1psTIYYtheQrU0hBksQ/dXYPIKGR3g0XdnSDmjQUMSK0RRwq+nUIrgc0ANfZ3w7zEzyBlt9OoqZ2XlxF50FfZpGd9Vu3uk0gJnoxnWOVFlW9HEjC6gjipNmZpGXiSMmBGKdjOscrptGGFeFqgZZVkNUdohqqaPYtBHZnPohCkfiu+5w4vTqN0qmXn/EkovR666GlcvlrCr60jqPobNRSw3l4lLWO1fQ79a5Z6G0UtxamhtoEmiTew+JoU9VuVQKfowR5an0CyINS3MpJ9NUlESi4g+VCyQP5lAMmmkSDNtE+kI1loOCRlhJTym6unYVV8IpPpSefGgUlJ1dZptdt0PGZSjZXbKUol07Q3kl9+E5hRq7DIG9ZpLfdS+jiWOOFu0iJjRtOoyaE8QirAJ0ytMHzGji9MYeVIjY4uJXjLSxIdJzK6ijkoZ906QcMRJt4kFnQ9j9nI0Ma8Kxdi0ELVRNLikGgTSavEhJOUg1IySZ0QGtmGS5WPC8bRh9XKKza4ISO5WXgPSIR4RMOJQj4vQc2n6x4zePWobISxpbFsUKNs1jrAlJJwsGe+XgBPIp6XChFDT+yN4eeuJsW01QE4trFwD9Jg8Z2KVWK4AOoCDwWd6ipFGsToS6SnDwXD2rfQ5ZYYj1MOrKBt2Sz25qNp1FPUKJaB+HGVRrJm+jDTttJs9D3l15mmLijdfHGfUzFBL8WaKRPqbREIife2I1ASnEdq6hWYhpFuc+6eIxr8DF41yOPbevaPBSSpBSRu7XnYd4Gv3H8L5uXmcn59g7sg6N3/83QRz8wt47dw5R/7ZDu/lR9/s44MPP8Jb797C9Rvv4/o7N/8bbtzE2+/dIsdtCFfnu5+eY2//Zzz+dh87X3+P7a+eYofYfgWme+SMnBUO4foHQFfiiewvd28AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"handset\"\n        title=\"handset\"\n        src=\"/static/bfc4c520ad6b2c659b9e799fe2753790/9bbaf/handSetJs.png\"\n        srcset=\"/static/bfc4c520ad6b2c659b9e799fe2753790/12f09/handSetJs.png 148w,\n/static/bfc4c520ad6b2c659b9e799fe2753790/e4a3f/handSetJs.png 295w,\n/static/bfc4c520ad6b2c659b9e799fe2753790/9bbaf/handSetJs.png 588w\"\n        sizes=\"(max-width: 588px) 100vw, 588px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n这里我们实现双向绑定的思路是，视图层对数据的绑定是通过特定的属性<code class=\"language-text\">q-*</code>，来将<code class=\"language-text\">UI</code>和<code class=\"language-text\">Model</code>绑定起来，使用事件回调监测数据的变化，更新数据，然后刷新<code class=\"language-text\">UI</code>。</p>\n<h1 id=\"脏检测\" style=\"position:relative;\"><a href=\"#%E8%84%8F%E6%A3%80%E6%B5%8B\" aria-label=\"脏检测 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>脏检测</h1>\n<p><code class=\"language-text\">AngularJS</code>的数据双向绑定是基于脏检查的机制，脏检查的大致实现思想是，在数据层上维护变量的当前值，当视图层上的操作引起数据更新时，会执行脏检测，如果有绑定的变量的值发生了变化，变量对应的指令就会刷新数据绑定的<code class=\"language-text\">UI</code>；同样的脏检查机制的实现，我们在<code class=\"language-text\">DOM</code>上的也有绑定两个东西，一个是数据层上的变量的应用，<code class=\"language-text\">UI</code>更新的时候更新对应的变量，然后另外就是绑定的指令，用来执行具体的<code class=\"language-text\">UI</code>层面的更新逻辑。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.02702702702702%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtklEQVQ4y52U20/UQBTG98WgsDywbNtpO213Op22e4FNFP8o1JCIBBRE4gOKCkRDQGKQi/ECQozRmPjHNfk803JbrsLDL3PrfPOd0zNTWtv+hdGJaYxMTGJ49AnuXYPhh48xNj2LrR9/UXq+uIoWq0DU+3Cj3IPuW93oLpeP6DlG+TQ9vb3o6roJHggsrX9D6dncWzheDUo2wIWAG8ZgDodlO4Rb4OyTz3XCaL5qWlBpA/MrGyhNzS7AsCzU40HESQtB1ITvRYQE5yJvXTqdiQimXWw2LNZBpb+KUCV4tbSG0lMSrFSrSNMWkqQJlzmwiZObDrhIcK4QXMwFHddDIxlC6odohymF4sGgzdUTnCV6QrBwyBhHU91F6CskQQLflzCZfWrz5Q5fLKKPJqSK85CVShFIBYMSfp6jSwW1w0BIxKqJoBbBljFML0C/YXSInid8pkNBrgZbQ5Ak7Dk+PB4ioL9tUy6v5jDPoQGLuWhQDhtBhBY5tEiU2fzMPP6HYBU2bU5lGypsIhYpUScxnUezCPkqgjpXrtAFHOVOdR06dMBFrg6hCLShQ0F9U7SLpN4Gpx9i6KtE5D/EMNFPa5X9fj7OORrrWu077dCkfLmQJBintxHFA6hRHu0ohUf1KGspuB5Lqk+KIojqeSV4NZnffdPzESUdZWOAcY4wGYCgwhYiBld1OKqBgG6NEAl4FMOpKXgR9dNBuFFE39AhQlEUFmR83CGFFbbvwKeHwbE9MDpR16Hl12ASBr0+jPJqcpr3RbHm0otEJlgQUkpMCDowfxxm5t5ltu9njkwy03YyenkIlpmE7ps51Gd23h6Mi/WipZRlcb2Vzb/fzEorn/YwPvMSDx5N4v51GJvCyPg0dKQfvv5E6ePO7y/Lm993Fla3dl8vr+9dlTeE3ruytbu9sfvn8z+NNHpMrUJNegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"dirtyCheckHtml\"\n        title=\"dirtyCheckHtml\"\n        src=\"/static/b62136dacee091cedda6472b57d18c59/fcda8/dirtyCheckHTML.png\"\n        srcset=\"/static/b62136dacee091cedda6472b57d18c59/12f09/dirtyCheckHTML.png 148w,\n/static/b62136dacee091cedda6472b57d18c59/e4a3f/dirtyCheckHTML.png 295w,\n/static/b62136dacee091cedda6472b57d18c59/fcda8/dirtyCheckHTML.png 590w,\n/static/b62136dacee091cedda6472b57d18c59/a6d36/dirtyCheckHTML.png 650w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 588px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 228.3783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"dirtyCheckJs\"\n        title=\"dirtyCheckJs\"\n        src=\"/static/7ad9370138dc63b7095da4782d30f90c/9bbaf/dirtyCheckJs.png\"\n        srcset=\"/static/7ad9370138dc63b7095da4782d30f90c/12f09/dirtyCheckJs.png 148w,\n/static/7ad9370138dc63b7095da4782d30f90c/e4a3f/dirtyCheckJs.png 295w,\n/static/7ad9370138dc63b7095da4782d30f90c/9bbaf/dirtyCheckJs.png 588w\"\n        sizes=\"(max-width: 588px) 100vw, 588px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h1 id=\"数据劫持\" style=\"position:relative;\"><a href=\"#%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81\" aria-label=\"数据劫持 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>数据劫持</h1>\n<p>实现双向绑定的另一种方式是，使用数据劫持的方式，给数据层的属性定制<code class=\"language-text\">getter</code>和<code class=\"language-text\">setter</code>，在<code class=\"language-text\">UI</code>上触发了回调函数更新数据的时候，会调到我们定制的<code class=\"language-text\">setter</code>中，在<code class=\"language-text\">setter</code>中会刷新<code class=\"language-text\">UI</code>。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.78378378378379%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC8UlEQVQ4y51VS08TURjtGvtAOtN5dt7TmekLsSb+BFkIQV2w0ZUrVkZiUDBBJRoMIMEgEdQoMYFEBXQjJuKGjfys47ltISBpsC5O7r3tvec79/vOdyf1+cc+tn8dYOvnb2wL7HWPnb0D7JDj0+4+Um82v2Fichp3Jqcwdm8SY3cfdIfx1jj+cAYfvnxHanpuGQ1TQVDJI631IZvJIdvbS5xvj0SuM3Lcdy6TgV60sPB6Hampp/NQDAtWMYCiaZANE7KqQlIUyIpKKCioWkcomg6poMDxAzxbWkVq4tEsdNNANR5AnNQQ1i7DcWPYlg/N9aHafpu4M/KyDMv1MLPwCqn7j58zQgEJyeq1AWiqDlU1oGomCnoL4pBQ0ZFQIqHj4cl8mzAvF6iyiCQagG956KcqVS82IwuiQ7JOpKcJqbBQ0FAOGii5CWpODN8rQ2duzyLrqNCyXZSCKjw3gu8EvLrBzdrRoS4JZXhBiHLSjySuIqjWofulEyRdKyzaDlwvgFm0IbEwx4vRfQ4FoeWgWmYOfV7ZclE0PXrTp32Cpt+6U8iiKFRVDi8hYVEaYUznu/zNIJn+f1cW3ov9OsolGtyvouJVYNthM9hRHv+VULSX6bEzWN2CqCzVKO0KS2d0ySlC0XqyqqAU1WH7MWSdV6TJhTKxUaJ6cYO8JHEuN+fSIdppaLbecYXiD1Uz4LJLougCwkoDvluCSetoLJLFwjhhAi2IYNoeDJc+JVSz9TD0MdipHCqGDjeqwrWFsUlCIoNrk6qtgIjrMEMGCSN6NIJiWjxjECZtZvBx8Em43CIUz5ZX7YefXGzZxWEvc4NOFboXQuXaYBuKfhdzYXrdK8FwHAakWs4dqm8TziIn5ZHng5BlztJ8LNPZLDIcM8fGdBvNufgtI8bWuqenp+nVmRcrSM2tvMfI6E0MDl/HlasjxLUWhv4aj2Po5Hxw+AZGb93G0tsNpMR3YG3ja3OxuPYRi6tdgmdevtuE+Datb+3iD2vy0WupJFUpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hijackingHTML\"\n        title=\"hijackingHTML\"\n        src=\"/static/3c12a9b983da2392d418567bd376f722/fcda8/hiijackingHTML.png\"\n        srcset=\"/static/3c12a9b983da2392d418567bd376f722/12f09/hiijackingHTML.png 148w,\n/static/3c12a9b983da2392d418567bd376f722/e4a3f/hiijackingHTML.png 295w,\n/static/3c12a9b983da2392d418567bd376f722/fcda8/hiijackingHTML.png 590w,\n/static/3c12a9b983da2392d418567bd376f722/36bb5/hiijackingHTML.png 611w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 588px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 185.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAlCAYAAABCr8kFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFS0lEQVRIx5VWTY8UVRTttcDM0N31Xa++Xn1Xd0/PDMLC36HGBFAJJArERGKixr2A6IIB8YPRQRMSEIgrRV25wF+i/IzO8bzXPdBjV49hcaq7q+uduu/ec899nfu//IkHf/yFnx4/wYPfnuDh7y+OR1yvcI9cnd1Hj3Hpg0/wznsXcfrCRZw6ex6nzl1YgvMLOM37J7nm/KWPcYdcneu79/ByXqLK17AadHH40AqOrK7g8MoUR1ZWCXVvtRUra2t46dAhhInEzd376Fy7dQf1cIBUBgiyAYK8QhBGcN0ArhfA9gQsBceFaTsLUPd7homsrPH5V3fQuXpzBylJkqBCnW0gT4Yo0zGabEtD5kN4zQZEXsPm4r5pwbDsfej2+kiyAldvfofO5e3baFSESYggrSFiycgEHGcKy/Fger6OUkV0IOGNHXSubO+gqGskkUSQFLCF4EMWeqapF0/B74bZStZCeJuEDf8wYdjMh+2hz4c0Qd/Q+XlOvIjWCMuG+StSpM0Iw+NbqJuc28/hZjX8JIPJ3BkK3LIiMPli03LaI1SXJCt1wpPYR+jHiIIMrgjgxCm8lP8FMZwkh8VPy3EQilQ/Y5FYE/bnI+RFUodRIBGToGlClEWIiJF5fMijhCw/gOl6evH8Vg+IsIDBh5pGYmtcoKIeq2wTGV8kqgG8aoQoziHjktt/Xun2HN5QOixnIuXDhlowy5XO0yxXps0tevuI2qt8Q1V5MFdNc59M5he3bXeB8DKrXDU1hS3gckshhZ3JkK2UsD9V63noGsb0JXOkS2WjLpJVTqIYg5otmI8RF42GTAtEUYaAVVV9rbat0mDq6jpaRipVXep1H2HMhY5r4fhWgmI8hODvcXkCo+IEhsVxbFSvoCmPIUkHlBZfEubw/FArwA+FTtdClVVBgiiB7/qwuQ2bhbEsVaC5as5aUulurzWXyqZvGhg2KaqqRDDchD/YhJNmCJU+GVEWNyiSEb8XTA81SsPYIzy6kMO8wFq3jzwLmc+YulvXpB4jTuMaWTJALoco5DpBTUap7hINulHrltVN30/pi7QwX8AXDr+z6mwxxxUQgi/yQo0oVBFGOloFISLIosSVPWErt3VJYjJH/f+4i/EM+7W3VDbaYEdDai+AoLsItpkni6nREnaYwEtoEoEHm/38/wbLS16RyIshJT9VpbmFwE+0bfWsKVTkKlLtkazyvOHuI/z0+m2MN5jwioOpHCFYPwG/YZWLCg7TEEUec+bCDUJYIoRNZ3dpaY5Okd1uX1lZsnoF0mzMaNdR1vystxBzJBQZJSMpp2KTDcBccwc2q2xTNqbdQjjtlByG4aHMMzRVSIlITr8SkhW0bZ8KsJ459N5o6B8s7JyO7SFJqLs04IyOaBIZizSAYOSqGPOdcWBR9nTY7bHBIzVbmE+aRcRtxiQsyk0O/mS2eNFclxIqJxZCVTimTbGP2dOqC1R0yl0sNQJmc/lgx96eGqzLuaHfuJevmSloD5zBsO1nhVgaoXZsijnjgCpzzg36oUwqSG5fHUtiybMO5WSLqV25wtXnmeVzWcumQsnCNBXJijHPMexhnmlkWPKcs44wTKez2Z6mwuGItalDJZ0F2Vze/haj9WOMiMcREiTB1EA1CRe7NFtLaU5v2Wk9gfU4ItQo1oSfffn9RMpy4trBhHY06fZMwpj0+uaEPjc5avCz25usHe22g//xHDkJYjm5dmt30rn140O8+/6HeP3Ns3j15NtL8drJM+04dQZvvHWOHB9BcXV2H/769zd3f/7n+s7dp198/cNTHhpfCGqNWqs4FNe/LSKXlX1m0TQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hijackingJs\"\n        title=\"hijackingJs\"\n        src=\"/static/e0a87d1af9cf2795279397f5fdbc0b8d/9bbaf/hijackingJs.png\"\n        srcset=\"/static/e0a87d1af9cf2795279397f5fdbc0b8d/12f09/hijackingJs.png 148w,\n/static/e0a87d1af9cf2795279397f5fdbc0b8d/e4a3f/hijackingJs.png 295w,\n/static/e0a87d1af9cf2795279397f5fdbc0b8d/9bbaf/hijackingJs.png 588w\"\n        sizes=\"(max-width: 588px) 100vw, 588px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n在<code class=\"language-text\">DOM</code>属性上我们只需要指明引用的变量，具体的<code class=\"language-text\">UI</code>刷新逻辑定义在<code class=\"language-text\">setter</code>中。</p>\n<p>以上是实现一个双向绑定的常见手段，这里只是了解大致的原理，具体到不同的前端框架中实现的双向绑定，比文章中介绍的更复杂和更健壮，这里只是了解其原理，抓住主要实现原理，框架层面的实现也是基于这些原理来做的。\n文中的<a href=\"https://github.com/Soyn/demos/tree/master/mvvm\">Demo Code</a></p>\n<h1 id=\"refrence\" style=\"position:relative;\"><a href=\"#refrence\" aria-label=\"refrence permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Refrence</h1>\n<ul>\n<li><a href=\"https://jixianqianduan.com/frontend-javascript/2015/11/29/js-data-two-ways-binding.html\">javascript实现数据双向绑定的三种方式</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000004681757\">JavaScript数据双向绑定的简单演示 - 前端知识点小结 - SegmentFault 思否</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/25464162\">数据双向绑定的分析和简单实现 - 知乎</a></li>\n</ul>\n<hr>\n<p><strong><em>兴趣遍地都是，坚持和持之以恒才是稀缺的</em></strong></p>","frontmatter":{"title":"双向绑定","date":"June 15, 2019"}}},"pageContext":{"slug":"/2019-6-15-mvvm/","previous":{"fields":{"slug":"/2019-5-11-sameOriginPolicy/"},"frontmatter":{"title":"浏览器同源策略","category":"Tech"}},"next":{"fields":{"slug":"/平滑滚动/"},"frontmatter":{"title":"使用Passive event保证平滑滚动","category":"Tech"}}}},"staticQueryHashes":["3128451518","96099027"]}